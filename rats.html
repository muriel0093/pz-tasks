<main class="flex-shrink-0">
  <div class="container mt-4">
    <div class="mb-3">
      <h1 class="mb-4 text-center">Rats Abertos</h1>

      <div id="ratsContainer" class="list-group"></div>

      <div class="text-center">
        <button id="clearBtn" class="btn btn-danger mt-3" hidden>Limpar Tarefas</button>
      </div>
    </div>
  </div>
</main>
<script>
  (async function fetchData() {
    const dataPlace = document.getElementById("ratsContainer");
    dataPlace.innerHTML = ""; // limpa a lista antes de renderizar

    try {
      const response = await fetch("/GetTasks");
      if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
      const data = await response.json();

      const accordion = document.createElement("div");
      accordion.classList.add("accordion");
      accordion.id = "tasksAccordion";
      dataPlace.appendChild(accordion);

      data.rows.forEach((element, index) => {
        const item = document.createElement("div");
        item.classList.add("accordion-item");

        // alterna cor de fundo no header do accordion
        const bgColor =
          index % 2 === 0 ? "bg-primary text-white" : "bg-primary text-white";

        item.innerHTML = `
        <h2 class="accordion-header" id="heading${index}">
            <button class="accordion-button ${index !== 0 ? "collapsed" : ""
          } ${bgColor}" 
                    type="button" 
                    data-bs-toggle="collapse" 
                    data-bs-target="#collapse${index}" 
                    aria-expanded="${index === 0}" 
                    aria-controls="collapse${index}">
                ${element.titulo} <span class="badge bg-primary ms-2">${element.codigo
          }</span>
            </button>
        </h2>
        <div id="collapse${index}" 
             class="bg-dark accordion-collapse collapse ${index === 0 ? "show" : ""
          }" 
             aria-labelledby="heading${index}" 
             data-bs-parent="#tasksAccordion">
            <div class="accordion-body text-white">
                ${element.descricao}
            </div>
        </div>
    `;

        accordion.appendChild(item);
      });
    } catch (err) {
      console.log(err);
    }
  })();
</script>